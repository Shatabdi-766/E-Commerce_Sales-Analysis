WITH REVENUEGENERATED AS(
SELECT 
    OI.SELLER_ID, ROUND(SUM(PY.PAYMENT_VALUE),2) AS REVENUE
FROM
    ORDER_ITEMS OI
        JOIN
    PAYMENTS PY ON OI.ORDER_ID = PY.ORDER_ID
    GROUP BY 1)
    
    SELECT * ,
    DENSE_RANK() OVER (ORDER BY REVENUE DESC) AS RANK_REVENUE
    FROM REVENUEGENERATED;
